const mailer = require('nodemailer');
const pug = require('pug');

const transport = mailer.createTransport({
    host: "smtp.mailtrap.io",
    port: 2525,
    auth: {
      user: "bde6ec1c45e0ce", //generated by Mailtrap
      pass: "013978550e898b" //generated by Mailtrap
    }
  });

const mailOptions = {
    from: '"Служба восстановления паролей" <srv@pwd_recover.com>',
    to: '',
    subject: 'Восстановление пароля',
    text: '', 
    html: '' // генерировать по шаблону
};

exports.sendMail = (to, token) => {
    mailOptions.to = to
    mailOptions.html = pug.renderFile('/mail_templates/tmpl_main.pug', {link: '/recover/'+token})
    transport.sendMail(mailOptions, (error, info) => {
        if (error) {
          return console.log(error);
        }
        console.log('Message sent: %s', info.messageId);
      });
}